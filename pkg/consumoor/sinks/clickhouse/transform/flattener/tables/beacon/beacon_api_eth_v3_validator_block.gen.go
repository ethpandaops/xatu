// Code generated by chgo-rowgen; DO NOT EDIT.

package beacon

import (
	"net"

	"github.com/ClickHouse/ch-go/proto"
	"github.com/ethpandaops/xatu/pkg/consumoor/sinks/clickhouse/transform/flattener"
	"github.com/ethpandaops/xatu/pkg/consumoor/sinks/clickhouse/transform/metadata"
)

const beaconApiEthV3ValidatorBlockTableName flattener.TableName = "beacon_api_eth_v3_validator_block"

type beaconApiEthV3ValidatorBlockBatch struct {
	UpdatedDateTime                                  proto.ColDateTime
	EventDateTime                                    proto.ColDateTime64
	Slot                                             proto.ColUInt32
	SlotStartDateTime                                proto.ColDateTime
	Epoch                                            proto.ColUInt32
	EpochStartDateTime                               proto.ColDateTime
	BlockVersion                                     proto.ColStr
	BlockTotalBytes                                  *proto.ColNullable[uint32]
	BlockTotalBytesCompressed                        *proto.ColNullable[uint32]
	ConsensusPayloadValue                            *proto.ColNullable[uint64]
	ExecutionPayloadValue                            *proto.ColNullable[uint64]
	ExecutionPayloadBlockNumber                      proto.ColUInt32
	ExecutionPayloadBaseFeePerGas                    *proto.ColNullable[proto.UInt128]
	ExecutionPayloadBlobGasUsed                      *proto.ColNullable[uint64]
	ExecutionPayloadExcessBlobGas                    *proto.ColNullable[uint64]
	ExecutionPayloadGasLimit                         *proto.ColNullable[uint64]
	ExecutionPayloadGasUsed                          *proto.ColNullable[uint64]
	ExecutionPayloadTransactionsCount                *proto.ColNullable[uint32]
	ExecutionPayloadTransactionsTotalBytes           *proto.ColNullable[uint32]
	ExecutionPayloadTransactionsTotalBytesCompressed *proto.ColNullable[uint32]
	MetaClientName                                   proto.ColStr
	MetaClientID                                     proto.ColStr
	MetaClientVersion                                proto.ColStr
	MetaClientImplementation                         proto.ColStr
	MetaClientOS                                     proto.ColStr
	MetaClientIP                                     *proto.ColNullable[proto.IPv6]
	MetaClientGeoCity                                proto.ColStr
	MetaClientGeoCountry                             proto.ColStr
	MetaClientGeoCountryCode                         proto.ColStr
	MetaClientGeoContinentCode                       proto.ColStr
	MetaClientGeoLongitude                           *proto.ColNullable[float64]
	MetaClientGeoLatitude                            *proto.ColNullable[float64]
	MetaClientGeoAutonomousSystemNumber              *proto.ColNullable[uint32]
	MetaClientGeoAutonomousSystemOrganization        *proto.ColNullable[string]
	MetaNetworkID                                    proto.ColInt32
	MetaNetworkName                                  proto.ColStr
	MetaConsensusVersion                             proto.ColStr
	MetaConsensusVersionMajor                        proto.ColStr
	MetaConsensusVersionMinor                        proto.ColStr
	MetaConsensusVersionPatch                        proto.ColStr
	MetaConsensusImplementation                      proto.ColStr
	MetaLabels                                       *proto.ColMap[string, string]
	rows                                             int
}

func newbeaconApiEthV3ValidatorBlockBatch() *beaconApiEthV3ValidatorBlockBatch {
	return &beaconApiEthV3ValidatorBlockBatch{
		EventDateTime:                                    func() proto.ColDateTime64 { var c proto.ColDateTime64; c.WithPrecision(proto.Precision(3)); return c }(),
		BlockTotalBytes:                                  new(proto.ColUInt32).Nullable(),
		BlockTotalBytesCompressed:                        new(proto.ColUInt32).Nullable(),
		ConsensusPayloadValue:                            new(proto.ColUInt64).Nullable(),
		ExecutionPayloadValue:                            new(proto.ColUInt64).Nullable(),
		ExecutionPayloadBaseFeePerGas:                    new(proto.ColUInt128).Nullable(),
		ExecutionPayloadBlobGasUsed:                      new(proto.ColUInt64).Nullable(),
		ExecutionPayloadExcessBlobGas:                    new(proto.ColUInt64).Nullable(),
		ExecutionPayloadGasLimit:                         new(proto.ColUInt64).Nullable(),
		ExecutionPayloadGasUsed:                          new(proto.ColUInt64).Nullable(),
		ExecutionPayloadTransactionsCount:                new(proto.ColUInt32).Nullable(),
		ExecutionPayloadTransactionsTotalBytes:           new(proto.ColUInt32).Nullable(),
		ExecutionPayloadTransactionsTotalBytesCompressed: new(proto.ColUInt32).Nullable(),
		MetaClientIP:                                     new(proto.ColIPv6).Nullable(),
		MetaClientGeoLongitude:                           new(proto.ColFloat64).Nullable(),
		MetaClientGeoLatitude:                            new(proto.ColFloat64).Nullable(),
		MetaClientGeoAutonomousSystemNumber:              new(proto.ColUInt32).Nullable(),
		MetaClientGeoAutonomousSystemOrganization:        new(proto.ColStr).Nullable(),
		MetaLabels:                                       proto.NewMap[string, string](new(proto.ColStr), new(proto.ColStr)),
	}
}

func (b *beaconApiEthV3ValidatorBlockBatch) Rows() int {
	return b.rows
}

func (b *beaconApiEthV3ValidatorBlockBatch) appendMetadata(meta *metadata.CommonMetadata) {
	if meta == nil {
		b.MetaClientName.Append("")
		b.MetaClientID.Append("")
		b.MetaClientVersion.Append("")
		b.MetaClientImplementation.Append("")
		b.MetaClientOS.Append("")
		b.MetaClientIP.Append(proto.Nullable[proto.IPv6]{})
		b.MetaClientGeoCity.Append("")
		b.MetaClientGeoCountry.Append("")
		b.MetaClientGeoCountryCode.Append("")
		b.MetaClientGeoContinentCode.Append("")
		b.MetaClientGeoLongitude.Append(proto.Nullable[float64]{})
		b.MetaClientGeoLatitude.Append(proto.Nullable[float64]{})
		b.MetaClientGeoAutonomousSystemNumber.Append(proto.Nullable[uint32]{})
		b.MetaClientGeoAutonomousSystemOrganization.Append(proto.Nullable[string]{})
		b.MetaNetworkID.Append(0)
		b.MetaNetworkName.Append("")
		b.MetaConsensusVersion.Append("")
		b.MetaConsensusVersionMajor.Append("")
		b.MetaConsensusVersionMinor.Append("")
		b.MetaConsensusVersionPatch.Append("")
		b.MetaConsensusImplementation.Append("")
		b.MetaLabels.Append(nil)
		return
	}

	b.MetaClientName.Append(meta.MetaClientName)
	b.MetaClientID.Append(meta.MetaClientID)
	b.MetaClientVersion.Append(meta.MetaClientVersion)
	b.MetaClientImplementation.Append(meta.MetaClientImplementation)
	b.MetaClientOS.Append(meta.MetaClientOS)
	b.MetaClientIP.Append(proto.NewNullable[proto.IPv6](flattener.ParseIPv6(meta.MetaClientIP)))
	b.MetaClientGeoCity.Append(meta.MetaClientGeoCity)
	b.MetaClientGeoCountry.Append(meta.MetaClientGeoCountry)
	b.MetaClientGeoCountryCode.Append(meta.MetaClientGeoCountryCode)
	b.MetaClientGeoContinentCode.Append(meta.MetaClientGeoContinentCode)
	b.MetaClientGeoLongitude.Append(proto.NewNullable[float64](meta.MetaClientGeoLongitude))
	b.MetaClientGeoLatitude.Append(proto.NewNullable[float64](meta.MetaClientGeoLatitude))
	b.MetaClientGeoAutonomousSystemNumber.Append(proto.NewNullable[uint32](meta.MetaClientGeoAutonomousSystemNumber))
	b.MetaClientGeoAutonomousSystemOrganization.Append(proto.NewNullable[string](meta.MetaClientGeoAutonomousSystemOrganization))
	b.MetaNetworkID.Append(int32(meta.MetaNetworkID))
	b.MetaNetworkName.Append(meta.MetaNetworkName)
	b.MetaConsensusVersion.Append(meta.MetaConsensusVersion)
	b.MetaConsensusVersionMajor.Append(meta.MetaConsensusVersionMajor)
	b.MetaConsensusVersionMinor.Append(meta.MetaConsensusVersionMinor)
	b.MetaConsensusVersionPatch.Append(meta.MetaConsensusVersionPatch)
	b.MetaConsensusImplementation.Append(meta.MetaConsensusImplementation)
	if meta.MetaLabels != nil {
		b.MetaLabels.Append(meta.MetaLabels)
	} else {
		b.MetaLabels.Append(map[string]string{})
	}
}

func (b *beaconApiEthV3ValidatorBlockBatch) Input() proto.Input {
	return proto.Input{
		{Name: "updated_date_time", Data: &b.UpdatedDateTime},
		{Name: "event_date_time", Data: &b.EventDateTime},
		{Name: "slot", Data: &b.Slot},
		{Name: "slot_start_date_time", Data: &b.SlotStartDateTime},
		{Name: "epoch", Data: &b.Epoch},
		{Name: "epoch_start_date_time", Data: &b.EpochStartDateTime},
		{Name: "block_version", Data: &b.BlockVersion},
		{Name: "block_total_bytes", Data: b.BlockTotalBytes},
		{Name: "block_total_bytes_compressed", Data: b.BlockTotalBytesCompressed},
		{Name: "consensus_payload_value", Data: b.ConsensusPayloadValue},
		{Name: "execution_payload_value", Data: b.ExecutionPayloadValue},
		{Name: "execution_payload_block_number", Data: &b.ExecutionPayloadBlockNumber},
		{Name: "execution_payload_base_fee_per_gas", Data: b.ExecutionPayloadBaseFeePerGas},
		{Name: "execution_payload_blob_gas_used", Data: b.ExecutionPayloadBlobGasUsed},
		{Name: "execution_payload_excess_blob_gas", Data: b.ExecutionPayloadExcessBlobGas},
		{Name: "execution_payload_gas_limit", Data: b.ExecutionPayloadGasLimit},
		{Name: "execution_payload_gas_used", Data: b.ExecutionPayloadGasUsed},
		{Name: "execution_payload_transactions_count", Data: b.ExecutionPayloadTransactionsCount},
		{Name: "execution_payload_transactions_total_bytes", Data: b.ExecutionPayloadTransactionsTotalBytes},
		{Name: "execution_payload_transactions_total_bytes_compressed", Data: b.ExecutionPayloadTransactionsTotalBytesCompressed},
		{Name: "meta_client_name", Data: &b.MetaClientName},
		{Name: "meta_client_id", Data: &b.MetaClientID},
		{Name: "meta_client_version", Data: &b.MetaClientVersion},
		{Name: "meta_client_implementation", Data: &b.MetaClientImplementation},
		{Name: "meta_client_os", Data: &b.MetaClientOS},
		{Name: "meta_client_ip", Data: b.MetaClientIP},
		{Name: "meta_client_geo_city", Data: &b.MetaClientGeoCity},
		{Name: "meta_client_geo_country", Data: &b.MetaClientGeoCountry},
		{Name: "meta_client_geo_country_code", Data: &b.MetaClientGeoCountryCode},
		{Name: "meta_client_geo_continent_code", Data: &b.MetaClientGeoContinentCode},
		{Name: "meta_client_geo_longitude", Data: b.MetaClientGeoLongitude},
		{Name: "meta_client_geo_latitude", Data: b.MetaClientGeoLatitude},
		{Name: "meta_client_geo_autonomous_system_number", Data: b.MetaClientGeoAutonomousSystemNumber},
		{Name: "meta_client_geo_autonomous_system_organization", Data: b.MetaClientGeoAutonomousSystemOrganization},
		{Name: "meta_network_id", Data: &b.MetaNetworkID},
		{Name: "meta_network_name", Data: &b.MetaNetworkName},
		{Name: "meta_consensus_version", Data: &b.MetaConsensusVersion},
		{Name: "meta_consensus_version_major", Data: &b.MetaConsensusVersionMajor},
		{Name: "meta_consensus_version_minor", Data: &b.MetaConsensusVersionMinor},
		{Name: "meta_consensus_version_patch", Data: &b.MetaConsensusVersionPatch},
		{Name: "meta_consensus_implementation", Data: &b.MetaConsensusImplementation},
		{Name: "meta_labels", Data: b.MetaLabels},
	}
}

func (b *beaconApiEthV3ValidatorBlockBatch) Reset() {
	b.UpdatedDateTime.Reset()
	b.EventDateTime.Reset()
	b.Slot.Reset()
	b.SlotStartDateTime.Reset()
	b.Epoch.Reset()
	b.EpochStartDateTime.Reset()
	b.BlockVersion.Reset()
	b.BlockTotalBytes.Reset()
	b.BlockTotalBytesCompressed.Reset()
	b.ConsensusPayloadValue.Reset()
	b.ExecutionPayloadValue.Reset()
	b.ExecutionPayloadBlockNumber.Reset()
	b.ExecutionPayloadBaseFeePerGas.Reset()
	b.ExecutionPayloadBlobGasUsed.Reset()
	b.ExecutionPayloadExcessBlobGas.Reset()
	b.ExecutionPayloadGasLimit.Reset()
	b.ExecutionPayloadGasUsed.Reset()
	b.ExecutionPayloadTransactionsCount.Reset()
	b.ExecutionPayloadTransactionsTotalBytes.Reset()
	b.ExecutionPayloadTransactionsTotalBytesCompressed.Reset()
	b.MetaClientName.Reset()
	b.MetaClientID.Reset()
	b.MetaClientVersion.Reset()
	b.MetaClientImplementation.Reset()
	b.MetaClientOS.Reset()
	b.MetaClientIP.Reset()
	b.MetaClientGeoCity.Reset()
	b.MetaClientGeoCountry.Reset()
	b.MetaClientGeoCountryCode.Reset()
	b.MetaClientGeoContinentCode.Reset()
	b.MetaClientGeoLongitude.Reset()
	b.MetaClientGeoLatitude.Reset()
	b.MetaClientGeoAutonomousSystemNumber.Reset()
	b.MetaClientGeoAutonomousSystemOrganization.Reset()
	b.MetaNetworkID.Reset()
	b.MetaNetworkName.Reset()
	b.MetaConsensusVersion.Reset()
	b.MetaConsensusVersionMajor.Reset()
	b.MetaConsensusVersionMinor.Reset()
	b.MetaConsensusVersionPatch.Reset()
	b.MetaConsensusImplementation.Reset()
	b.MetaLabels.Reset()
	b.rows = 0
}

func (b *beaconApiEthV3ValidatorBlockBatch) Snapshot() []map[string]any {
	n := b.rows
	out := make([]map[string]any, n)

	for i := 0; i < n; i++ {
		row := make(map[string]any, 42)
		row["updated_date_time"] = b.UpdatedDateTime.Row(i).Unix()
		row["event_date_time"] = b.EventDateTime.Row(i).UnixMilli()
		row["slot"] = b.Slot.Row(i)
		row["slot_start_date_time"] = b.SlotStartDateTime.Row(i).Unix()
		row["epoch"] = b.Epoch.Row(i)
		row["epoch_start_date_time"] = b.EpochStartDateTime.Row(i).Unix()
		row["block_version"] = b.BlockVersion.Row(i)
		if v := b.BlockTotalBytes.Row(i); v.Set {
			row["block_total_bytes"] = v.Value
		} else {
			row["block_total_bytes"] = nil
		}
		if v := b.BlockTotalBytesCompressed.Row(i); v.Set {
			row["block_total_bytes_compressed"] = v.Value
		} else {
			row["block_total_bytes_compressed"] = nil
		}
		if v := b.ConsensusPayloadValue.Row(i); v.Set {
			row["consensus_payload_value"] = v.Value
		} else {
			row["consensus_payload_value"] = nil
		}
		if v := b.ExecutionPayloadValue.Row(i); v.Set {
			row["execution_payload_value"] = v.Value
		} else {
			row["execution_payload_value"] = nil
		}
		row["execution_payload_block_number"] = b.ExecutionPayloadBlockNumber.Row(i)
		if v := b.ExecutionPayloadBaseFeePerGas.Row(i); v.Set {
			row["execution_payload_base_fee_per_gas"] = flattener.UInt128ToString(v.Value)
		} else {
			row["execution_payload_base_fee_per_gas"] = nil
		}
		if v := b.ExecutionPayloadBlobGasUsed.Row(i); v.Set {
			row["execution_payload_blob_gas_used"] = v.Value
		} else {
			row["execution_payload_blob_gas_used"] = nil
		}
		if v := b.ExecutionPayloadExcessBlobGas.Row(i); v.Set {
			row["execution_payload_excess_blob_gas"] = v.Value
		} else {
			row["execution_payload_excess_blob_gas"] = nil
		}
		if v := b.ExecutionPayloadGasLimit.Row(i); v.Set {
			row["execution_payload_gas_limit"] = v.Value
		} else {
			row["execution_payload_gas_limit"] = nil
		}
		if v := b.ExecutionPayloadGasUsed.Row(i); v.Set {
			row["execution_payload_gas_used"] = v.Value
		} else {
			row["execution_payload_gas_used"] = nil
		}
		if v := b.ExecutionPayloadTransactionsCount.Row(i); v.Set {
			row["execution_payload_transactions_count"] = v.Value
		} else {
			row["execution_payload_transactions_count"] = nil
		}
		if v := b.ExecutionPayloadTransactionsTotalBytes.Row(i); v.Set {
			row["execution_payload_transactions_total_bytes"] = v.Value
		} else {
			row["execution_payload_transactions_total_bytes"] = nil
		}
		if v := b.ExecutionPayloadTransactionsTotalBytesCompressed.Row(i); v.Set {
			row["execution_payload_transactions_total_bytes_compressed"] = v.Value
		} else {
			row["execution_payload_transactions_total_bytes_compressed"] = nil
		}
		row["meta_client_name"] = b.MetaClientName.Row(i)
		row["meta_client_id"] = b.MetaClientID.Row(i)
		row["meta_client_version"] = b.MetaClientVersion.Row(i)
		row["meta_client_implementation"] = b.MetaClientImplementation.Row(i)
		row["meta_client_os"] = b.MetaClientOS.Row(i)
		if v := b.MetaClientIP.Row(i); v.Set {
			row["meta_client_ip"] = net.IP(v.Value[:]).String()
		} else {
			row["meta_client_ip"] = nil
		}
		row["meta_client_geo_city"] = b.MetaClientGeoCity.Row(i)
		row["meta_client_geo_country"] = b.MetaClientGeoCountry.Row(i)
		row["meta_client_geo_country_code"] = b.MetaClientGeoCountryCode.Row(i)
		row["meta_client_geo_continent_code"] = b.MetaClientGeoContinentCode.Row(i)
		if v := b.MetaClientGeoLongitude.Row(i); v.Set {
			row["meta_client_geo_longitude"] = v.Value
		} else {
			row["meta_client_geo_longitude"] = nil
		}
		if v := b.MetaClientGeoLatitude.Row(i); v.Set {
			row["meta_client_geo_latitude"] = v.Value
		} else {
			row["meta_client_geo_latitude"] = nil
		}
		if v := b.MetaClientGeoAutonomousSystemNumber.Row(i); v.Set {
			row["meta_client_geo_autonomous_system_number"] = v.Value
		} else {
			row["meta_client_geo_autonomous_system_number"] = nil
		}
		if v := b.MetaClientGeoAutonomousSystemOrganization.Row(i); v.Set {
			row["meta_client_geo_autonomous_system_organization"] = v.Value
		} else {
			row["meta_client_geo_autonomous_system_organization"] = nil
		}
		row["meta_network_id"] = b.MetaNetworkID.Row(i)
		row["meta_network_name"] = b.MetaNetworkName.Row(i)
		row["meta_consensus_version"] = b.MetaConsensusVersion.Row(i)
		row["meta_consensus_version_major"] = b.MetaConsensusVersionMajor.Row(i)
		row["meta_consensus_version_minor"] = b.MetaConsensusVersionMinor.Row(i)
		row["meta_consensus_version_patch"] = b.MetaConsensusVersionPatch.Row(i)
		row["meta_consensus_implementation"] = b.MetaConsensusImplementation.Row(i)
		row["meta_labels"] = b.MetaLabels.Row(i)
		out[i] = row
	}

	return out
}
