// Code generated by chgo-rowgen; DO NOT EDIT.

package canonical

import (
	"net"

	"github.com/ClickHouse/ch-go/proto"
	"github.com/ethpandaops/xatu/pkg/consumoor/sinks/clickhouse/transform/flattener"
	"github.com/ethpandaops/xatu/pkg/consumoor/sinks/clickhouse/transform/metadata"
)

const canonicalBeaconBlockProposerSlashingTableName flattener.TableName = "canonical_beacon_block_proposer_slashing"

type canonicalBeaconBlockProposerSlashingBatch struct {
	UpdatedDateTime                           proto.ColDateTime
	Slot                                      proto.ColUInt32
	SlotStartDateTime                         proto.ColDateTime
	Epoch                                     proto.ColUInt32
	EpochStartDateTime                        proto.ColDateTime
	BlockRoot                                 flattener.SafeColFixedStr
	BlockVersion                              proto.ColStr
	SignedHeader1MessageSlot                  proto.ColUInt32
	SignedHeader1MessageProposerIndex         proto.ColUInt32
	SignedHeader1MessageBodyRoot              flattener.SafeColFixedStr
	SignedHeader1MessageParentRoot            flattener.SafeColFixedStr
	SignedHeader1MessageStateRoot             flattener.SafeColFixedStr
	SignedHeader1Signature                    proto.ColStr
	SignedHeader2MessageSlot                  proto.ColUInt32
	SignedHeader2MessageProposerIndex         proto.ColUInt32
	SignedHeader2MessageBodyRoot              flattener.SafeColFixedStr
	SignedHeader2MessageParentRoot            flattener.SafeColFixedStr
	SignedHeader2MessageStateRoot             flattener.SafeColFixedStr
	SignedHeader2Signature                    proto.ColStr
	MetaClientName                            proto.ColStr
	MetaClientID                              proto.ColStr
	MetaClientVersion                         proto.ColStr
	MetaClientImplementation                  proto.ColStr
	MetaClientOS                              proto.ColStr
	MetaClientIP                              *proto.ColNullable[proto.IPv6]
	MetaClientGeoCity                         proto.ColStr
	MetaClientGeoCountry                      proto.ColStr
	MetaClientGeoCountryCode                  proto.ColStr
	MetaClientGeoContinentCode                proto.ColStr
	MetaClientGeoLongitude                    *proto.ColNullable[float64]
	MetaClientGeoLatitude                     *proto.ColNullable[float64]
	MetaClientGeoAutonomousSystemNumber       *proto.ColNullable[uint32]
	MetaClientGeoAutonomousSystemOrganization *proto.ColNullable[string]
	MetaNetworkID                             proto.ColInt32
	MetaNetworkName                           proto.ColStr
	MetaConsensusVersion                      proto.ColStr
	MetaConsensusVersionMajor                 proto.ColStr
	MetaConsensusVersionMinor                 proto.ColStr
	MetaConsensusVersionPatch                 proto.ColStr
	MetaConsensusImplementation               proto.ColStr
	MetaLabels                                *proto.ColMap[string, string]
	rows                                      int
}

func newcanonicalBeaconBlockProposerSlashingBatch() *canonicalBeaconBlockProposerSlashingBatch {
	return &canonicalBeaconBlockProposerSlashingBatch{
		BlockRoot:                                 func() flattener.SafeColFixedStr { var c flattener.SafeColFixedStr; c.SetSize(66); return c }(),
		SignedHeader1MessageBodyRoot:              func() flattener.SafeColFixedStr { var c flattener.SafeColFixedStr; c.SetSize(66); return c }(),
		SignedHeader1MessageParentRoot:            func() flattener.SafeColFixedStr { var c flattener.SafeColFixedStr; c.SetSize(66); return c }(),
		SignedHeader1MessageStateRoot:             func() flattener.SafeColFixedStr { var c flattener.SafeColFixedStr; c.SetSize(66); return c }(),
		SignedHeader2MessageBodyRoot:              func() flattener.SafeColFixedStr { var c flattener.SafeColFixedStr; c.SetSize(66); return c }(),
		SignedHeader2MessageParentRoot:            func() flattener.SafeColFixedStr { var c flattener.SafeColFixedStr; c.SetSize(66); return c }(),
		SignedHeader2MessageStateRoot:             func() flattener.SafeColFixedStr { var c flattener.SafeColFixedStr; c.SetSize(66); return c }(),
		MetaClientIP:                              new(proto.ColIPv6).Nullable(),
		MetaClientGeoLongitude:                    new(proto.ColFloat64).Nullable(),
		MetaClientGeoLatitude:                     new(proto.ColFloat64).Nullable(),
		MetaClientGeoAutonomousSystemNumber:       new(proto.ColUInt32).Nullable(),
		MetaClientGeoAutonomousSystemOrganization: new(proto.ColStr).Nullable(),
		MetaLabels:                                proto.NewMap[string, string](new(proto.ColStr), new(proto.ColStr)),
	}
}

func (b *canonicalBeaconBlockProposerSlashingBatch) Rows() int {
	return b.rows
}

func (b *canonicalBeaconBlockProposerSlashingBatch) appendMetadata(meta *metadata.CommonMetadata) {
	if meta == nil {
		b.MetaClientName.Append("")
		b.MetaClientID.Append("")
		b.MetaClientVersion.Append("")
		b.MetaClientImplementation.Append("")
		b.MetaClientOS.Append("")
		b.MetaClientIP.Append(proto.Nullable[proto.IPv6]{})
		b.MetaClientGeoCity.Append("")
		b.MetaClientGeoCountry.Append("")
		b.MetaClientGeoCountryCode.Append("")
		b.MetaClientGeoContinentCode.Append("")
		b.MetaClientGeoLongitude.Append(proto.Nullable[float64]{})
		b.MetaClientGeoLatitude.Append(proto.Nullable[float64]{})
		b.MetaClientGeoAutonomousSystemNumber.Append(proto.Nullable[uint32]{})
		b.MetaClientGeoAutonomousSystemOrganization.Append(proto.Nullable[string]{})
		b.MetaNetworkID.Append(0)
		b.MetaNetworkName.Append("")
		b.MetaConsensusVersion.Append("")
		b.MetaConsensusVersionMajor.Append("")
		b.MetaConsensusVersionMinor.Append("")
		b.MetaConsensusVersionPatch.Append("")
		b.MetaConsensusImplementation.Append("")
		b.MetaLabels.Append(nil)
		return
	}

	b.MetaClientName.Append(meta.MetaClientName)
	b.MetaClientID.Append(meta.MetaClientID)
	b.MetaClientVersion.Append(meta.MetaClientVersion)
	b.MetaClientImplementation.Append(meta.MetaClientImplementation)
	b.MetaClientOS.Append(meta.MetaClientOS)
	b.MetaClientIP.Append(proto.NewNullable[proto.IPv6](flattener.ParseIPv6(meta.MetaClientIP)))
	b.MetaClientGeoCity.Append(meta.MetaClientGeoCity)
	b.MetaClientGeoCountry.Append(meta.MetaClientGeoCountry)
	b.MetaClientGeoCountryCode.Append(meta.MetaClientGeoCountryCode)
	b.MetaClientGeoContinentCode.Append(meta.MetaClientGeoContinentCode)
	b.MetaClientGeoLongitude.Append(proto.NewNullable[float64](meta.MetaClientGeoLongitude))
	b.MetaClientGeoLatitude.Append(proto.NewNullable[float64](meta.MetaClientGeoLatitude))
	b.MetaClientGeoAutonomousSystemNumber.Append(proto.NewNullable[uint32](meta.MetaClientGeoAutonomousSystemNumber))
	b.MetaClientGeoAutonomousSystemOrganization.Append(proto.NewNullable[string](meta.MetaClientGeoAutonomousSystemOrganization))
	b.MetaNetworkID.Append(int32(meta.MetaNetworkID))
	b.MetaNetworkName.Append(meta.MetaNetworkName)
	b.MetaConsensusVersion.Append(meta.MetaConsensusVersion)
	b.MetaConsensusVersionMajor.Append(meta.MetaConsensusVersionMajor)
	b.MetaConsensusVersionMinor.Append(meta.MetaConsensusVersionMinor)
	b.MetaConsensusVersionPatch.Append(meta.MetaConsensusVersionPatch)
	b.MetaConsensusImplementation.Append(meta.MetaConsensusImplementation)
	if meta.MetaLabels != nil {
		b.MetaLabels.Append(meta.MetaLabels)
	} else {
		b.MetaLabels.Append(map[string]string{})
	}
}

func (b *canonicalBeaconBlockProposerSlashingBatch) Input() proto.Input {
	return proto.Input{
		{Name: "updated_date_time", Data: &b.UpdatedDateTime},
		{Name: "slot", Data: &b.Slot},
		{Name: "slot_start_date_time", Data: &b.SlotStartDateTime},
		{Name: "epoch", Data: &b.Epoch},
		{Name: "epoch_start_date_time", Data: &b.EpochStartDateTime},
		{Name: "block_root", Data: &b.BlockRoot},
		{Name: "block_version", Data: &b.BlockVersion},
		{Name: "signed_header_1_message_slot", Data: &b.SignedHeader1MessageSlot},
		{Name: "signed_header_1_message_proposer_index", Data: &b.SignedHeader1MessageProposerIndex},
		{Name: "signed_header_1_message_body_root", Data: &b.SignedHeader1MessageBodyRoot},
		{Name: "signed_header_1_message_parent_root", Data: &b.SignedHeader1MessageParentRoot},
		{Name: "signed_header_1_message_state_root", Data: &b.SignedHeader1MessageStateRoot},
		{Name: "signed_header_1_signature", Data: &b.SignedHeader1Signature},
		{Name: "signed_header_2_message_slot", Data: &b.SignedHeader2MessageSlot},
		{Name: "signed_header_2_message_proposer_index", Data: &b.SignedHeader2MessageProposerIndex},
		{Name: "signed_header_2_message_body_root", Data: &b.SignedHeader2MessageBodyRoot},
		{Name: "signed_header_2_message_parent_root", Data: &b.SignedHeader2MessageParentRoot},
		{Name: "signed_header_2_message_state_root", Data: &b.SignedHeader2MessageStateRoot},
		{Name: "signed_header_2_signature", Data: &b.SignedHeader2Signature},
		{Name: "meta_client_name", Data: &b.MetaClientName},
		{Name: "meta_client_id", Data: &b.MetaClientID},
		{Name: "meta_client_version", Data: &b.MetaClientVersion},
		{Name: "meta_client_implementation", Data: &b.MetaClientImplementation},
		{Name: "meta_client_os", Data: &b.MetaClientOS},
		{Name: "meta_client_ip", Data: b.MetaClientIP},
		{Name: "meta_client_geo_city", Data: &b.MetaClientGeoCity},
		{Name: "meta_client_geo_country", Data: &b.MetaClientGeoCountry},
		{Name: "meta_client_geo_country_code", Data: &b.MetaClientGeoCountryCode},
		{Name: "meta_client_geo_continent_code", Data: &b.MetaClientGeoContinentCode},
		{Name: "meta_client_geo_longitude", Data: b.MetaClientGeoLongitude},
		{Name: "meta_client_geo_latitude", Data: b.MetaClientGeoLatitude},
		{Name: "meta_client_geo_autonomous_system_number", Data: b.MetaClientGeoAutonomousSystemNumber},
		{Name: "meta_client_geo_autonomous_system_organization", Data: b.MetaClientGeoAutonomousSystemOrganization},
		{Name: "meta_network_id", Data: &b.MetaNetworkID},
		{Name: "meta_network_name", Data: &b.MetaNetworkName},
		{Name: "meta_consensus_version", Data: &b.MetaConsensusVersion},
		{Name: "meta_consensus_version_major", Data: &b.MetaConsensusVersionMajor},
		{Name: "meta_consensus_version_minor", Data: &b.MetaConsensusVersionMinor},
		{Name: "meta_consensus_version_patch", Data: &b.MetaConsensusVersionPatch},
		{Name: "meta_consensus_implementation", Data: &b.MetaConsensusImplementation},
		{Name: "meta_labels", Data: b.MetaLabels},
	}
}

func (b *canonicalBeaconBlockProposerSlashingBatch) Reset() {
	b.UpdatedDateTime.Reset()
	b.Slot.Reset()
	b.SlotStartDateTime.Reset()
	b.Epoch.Reset()
	b.EpochStartDateTime.Reset()
	b.BlockRoot.Reset()
	b.BlockVersion.Reset()
	b.SignedHeader1MessageSlot.Reset()
	b.SignedHeader1MessageProposerIndex.Reset()
	b.SignedHeader1MessageBodyRoot.Reset()
	b.SignedHeader1MessageParentRoot.Reset()
	b.SignedHeader1MessageStateRoot.Reset()
	b.SignedHeader1Signature.Reset()
	b.SignedHeader2MessageSlot.Reset()
	b.SignedHeader2MessageProposerIndex.Reset()
	b.SignedHeader2MessageBodyRoot.Reset()
	b.SignedHeader2MessageParentRoot.Reset()
	b.SignedHeader2MessageStateRoot.Reset()
	b.SignedHeader2Signature.Reset()
	b.MetaClientName.Reset()
	b.MetaClientID.Reset()
	b.MetaClientVersion.Reset()
	b.MetaClientImplementation.Reset()
	b.MetaClientOS.Reset()
	b.MetaClientIP.Reset()
	b.MetaClientGeoCity.Reset()
	b.MetaClientGeoCountry.Reset()
	b.MetaClientGeoCountryCode.Reset()
	b.MetaClientGeoContinentCode.Reset()
	b.MetaClientGeoLongitude.Reset()
	b.MetaClientGeoLatitude.Reset()
	b.MetaClientGeoAutonomousSystemNumber.Reset()
	b.MetaClientGeoAutonomousSystemOrganization.Reset()
	b.MetaNetworkID.Reset()
	b.MetaNetworkName.Reset()
	b.MetaConsensusVersion.Reset()
	b.MetaConsensusVersionMajor.Reset()
	b.MetaConsensusVersionMinor.Reset()
	b.MetaConsensusVersionPatch.Reset()
	b.MetaConsensusImplementation.Reset()
	b.MetaLabels.Reset()
	b.rows = 0
}

func (b *canonicalBeaconBlockProposerSlashingBatch) Snapshot() []map[string]any {
	n := b.rows
	out := make([]map[string]any, n)

	for i := 0; i < n; i++ {
		row := make(map[string]any, 41)
		row["updated_date_time"] = b.UpdatedDateTime.Row(i).Unix()
		row["slot"] = b.Slot.Row(i)
		row["slot_start_date_time"] = b.SlotStartDateTime.Row(i).Unix()
		row["epoch"] = b.Epoch.Row(i)
		row["epoch_start_date_time"] = b.EpochStartDateTime.Row(i).Unix()
		row["block_root"] = string(b.BlockRoot.Row(i))
		row["block_version"] = b.BlockVersion.Row(i)
		row["signed_header_1_message_slot"] = b.SignedHeader1MessageSlot.Row(i)
		row["signed_header_1_message_proposer_index"] = b.SignedHeader1MessageProposerIndex.Row(i)
		row["signed_header_1_message_body_root"] = string(b.SignedHeader1MessageBodyRoot.Row(i))
		row["signed_header_1_message_parent_root"] = string(b.SignedHeader1MessageParentRoot.Row(i))
		row["signed_header_1_message_state_root"] = string(b.SignedHeader1MessageStateRoot.Row(i))
		row["signed_header_1_signature"] = b.SignedHeader1Signature.Row(i)
		row["signed_header_2_message_slot"] = b.SignedHeader2MessageSlot.Row(i)
		row["signed_header_2_message_proposer_index"] = b.SignedHeader2MessageProposerIndex.Row(i)
		row["signed_header_2_message_body_root"] = string(b.SignedHeader2MessageBodyRoot.Row(i))
		row["signed_header_2_message_parent_root"] = string(b.SignedHeader2MessageParentRoot.Row(i))
		row["signed_header_2_message_state_root"] = string(b.SignedHeader2MessageStateRoot.Row(i))
		row["signed_header_2_signature"] = b.SignedHeader2Signature.Row(i)
		row["meta_client_name"] = b.MetaClientName.Row(i)
		row["meta_client_id"] = b.MetaClientID.Row(i)
		row["meta_client_version"] = b.MetaClientVersion.Row(i)
		row["meta_client_implementation"] = b.MetaClientImplementation.Row(i)
		row["meta_client_os"] = b.MetaClientOS.Row(i)
		if v := b.MetaClientIP.Row(i); v.Set {
			row["meta_client_ip"] = net.IP(v.Value[:]).String()
		} else {
			row["meta_client_ip"] = nil
		}
		row["meta_client_geo_city"] = b.MetaClientGeoCity.Row(i)
		row["meta_client_geo_country"] = b.MetaClientGeoCountry.Row(i)
		row["meta_client_geo_country_code"] = b.MetaClientGeoCountryCode.Row(i)
		row["meta_client_geo_continent_code"] = b.MetaClientGeoContinentCode.Row(i)
		if v := b.MetaClientGeoLongitude.Row(i); v.Set {
			row["meta_client_geo_longitude"] = v.Value
		} else {
			row["meta_client_geo_longitude"] = nil
		}
		if v := b.MetaClientGeoLatitude.Row(i); v.Set {
			row["meta_client_geo_latitude"] = v.Value
		} else {
			row["meta_client_geo_latitude"] = nil
		}
		if v := b.MetaClientGeoAutonomousSystemNumber.Row(i); v.Set {
			row["meta_client_geo_autonomous_system_number"] = v.Value
		} else {
			row["meta_client_geo_autonomous_system_number"] = nil
		}
		if v := b.MetaClientGeoAutonomousSystemOrganization.Row(i); v.Set {
			row["meta_client_geo_autonomous_system_organization"] = v.Value
		} else {
			row["meta_client_geo_autonomous_system_organization"] = nil
		}
		row["meta_network_id"] = b.MetaNetworkID.Row(i)
		row["meta_network_name"] = b.MetaNetworkName.Row(i)
		row["meta_consensus_version"] = b.MetaConsensusVersion.Row(i)
		row["meta_consensus_version_major"] = b.MetaConsensusVersionMajor.Row(i)
		row["meta_consensus_version_minor"] = b.MetaConsensusVersionMinor.Row(i)
		row["meta_consensus_version_patch"] = b.MetaConsensusVersionPatch.Row(i)
		row["meta_consensus_implementation"] = b.MetaConsensusImplementation.Row(i)
		row["meta_labels"] = b.MetaLabels.Row(i)
		out[i] = row
	}

	return out
}
