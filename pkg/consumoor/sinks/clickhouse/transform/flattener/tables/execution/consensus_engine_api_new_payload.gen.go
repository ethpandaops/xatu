// Code generated by chgo-rowgen; DO NOT EDIT.

package execution

import (
	"net"

	"github.com/ClickHouse/ch-go/proto"
	"github.com/ethpandaops/xatu/pkg/consumoor/sinks/clickhouse/transform/flattener"
	"github.com/ethpandaops/xatu/pkg/consumoor/sinks/clickhouse/transform/metadata"
)

const consensusEngineApiNewPayloadTableName flattener.TableName = "consensus_engine_api_new_payload"

type consensusEngineApiNewPayloadBatch struct {
	UpdatedDateTime                           proto.ColDateTime
	EventDateTime                             proto.ColDateTime64
	RequestedDateTime                         proto.ColDateTime64
	DurationMs                                proto.ColUInt64
	Slot                                      proto.ColUInt32
	SlotStartDateTime                         proto.ColDateTime
	Epoch                                     proto.ColUInt32
	EpochStartDateTime                        proto.ColDateTime
	BlockRoot                                 flattener.SafeColFixedStr
	ParentBlockRoot                           flattener.SafeColFixedStr
	ProposerIndex                             proto.ColUInt32
	BlockNumber                               proto.ColUInt64
	BlockHash                                 flattener.SafeColFixedStr
	ParentHash                                flattener.SafeColFixedStr
	GasUsed                                   proto.ColUInt64
	GasLimit                                  proto.ColUInt64
	TxCount                                   proto.ColUInt32
	BlobCount                                 proto.ColUInt32
	Status                                    proto.ColStr
	LatestValidHash                           *proto.ColNullable[[]byte]
	ValidationError                           *proto.ColNullable[string]
	MethodVersion                             proto.ColStr
	MetaExecutionVersion                      proto.ColStr
	MetaExecutionImplementation               proto.ColStr
	MetaExecutionVersionMajor                 proto.ColStr
	MetaExecutionVersionMinor                 proto.ColStr
	MetaExecutionVersionPatch                 proto.ColStr
	MetaClientName                            proto.ColStr
	MetaClientID                              proto.ColStr
	MetaClientVersion                         proto.ColStr
	MetaClientImplementation                  proto.ColStr
	MetaClientOS                              proto.ColStr
	MetaClientIP                              *proto.ColNullable[proto.IPv6]
	MetaClientGeoCity                         proto.ColStr
	MetaClientGeoCountry                      proto.ColStr
	MetaClientGeoCountryCode                  proto.ColStr
	MetaClientGeoContinentCode                proto.ColStr
	MetaClientGeoLongitude                    *proto.ColNullable[float64]
	MetaClientGeoLatitude                     *proto.ColNullable[float64]
	MetaClientGeoAutonomousSystemNumber       *proto.ColNullable[uint32]
	MetaClientGeoAutonomousSystemOrganization *proto.ColNullable[string]
	MetaNetworkID                             proto.ColInt32
	MetaNetworkName                           proto.ColStr
	rows                                      int
}

func newconsensusEngineApiNewPayloadBatch() *consensusEngineApiNewPayloadBatch {
	return &consensusEngineApiNewPayloadBatch{
		EventDateTime:                       func() proto.ColDateTime64 { var c proto.ColDateTime64; c.WithPrecision(proto.Precision(3)); return c }(),
		RequestedDateTime:                   func() proto.ColDateTime64 { var c proto.ColDateTime64; c.WithPrecision(proto.Precision(3)); return c }(),
		BlockRoot:                           func() flattener.SafeColFixedStr { var c flattener.SafeColFixedStr; c.SetSize(66); return c }(),
		ParentBlockRoot:                     func() flattener.SafeColFixedStr { var c flattener.SafeColFixedStr; c.SetSize(66); return c }(),
		BlockHash:                           func() flattener.SafeColFixedStr { var c flattener.SafeColFixedStr; c.SetSize(66); return c }(),
		ParentHash:                          func() flattener.SafeColFixedStr { var c flattener.SafeColFixedStr; c.SetSize(66); return c }(),
		LatestValidHash:                     flattener.NewNullableFixedStr(66),
		ValidationError:                     new(proto.ColStr).Nullable(),
		MetaClientIP:                        new(proto.ColIPv6).Nullable(),
		MetaClientGeoLongitude:              new(proto.ColFloat64).Nullable(),
		MetaClientGeoLatitude:               new(proto.ColFloat64).Nullable(),
		MetaClientGeoAutonomousSystemNumber: new(proto.ColUInt32).Nullable(),
		MetaClientGeoAutonomousSystemOrganization: new(proto.ColStr).Nullable(),
	}
}

func (b *consensusEngineApiNewPayloadBatch) Rows() int {
	return b.rows
}

func (b *consensusEngineApiNewPayloadBatch) appendMetadata(meta *metadata.CommonMetadata) {
	if meta == nil {
		b.MetaExecutionVersion.Append("")
		b.MetaExecutionImplementation.Append("")
		b.MetaExecutionVersionMajor.Append("")
		b.MetaExecutionVersionMinor.Append("")
		b.MetaExecutionVersionPatch.Append("")
		b.MetaClientName.Append("")
		b.MetaClientID.Append("")
		b.MetaClientVersion.Append("")
		b.MetaClientImplementation.Append("")
		b.MetaClientOS.Append("")
		b.MetaClientIP.Append(proto.Nullable[proto.IPv6]{})
		b.MetaClientGeoCity.Append("")
		b.MetaClientGeoCountry.Append("")
		b.MetaClientGeoCountryCode.Append("")
		b.MetaClientGeoContinentCode.Append("")
		b.MetaClientGeoLongitude.Append(proto.Nullable[float64]{})
		b.MetaClientGeoLatitude.Append(proto.Nullable[float64]{})
		b.MetaClientGeoAutonomousSystemNumber.Append(proto.Nullable[uint32]{})
		b.MetaClientGeoAutonomousSystemOrganization.Append(proto.Nullable[string]{})
		b.MetaNetworkID.Append(0)
		b.MetaNetworkName.Append("")
		return
	}

	b.MetaExecutionVersion.Append(meta.MetaExecutionVersion)
	b.MetaExecutionImplementation.Append(meta.MetaExecutionImplementation)
	b.MetaExecutionVersionMajor.Append(meta.MetaExecutionVersionMajor)
	b.MetaExecutionVersionMinor.Append(meta.MetaExecutionVersionMinor)
	b.MetaExecutionVersionPatch.Append(meta.MetaExecutionVersionPatch)
	b.MetaClientName.Append(meta.MetaClientName)
	b.MetaClientID.Append(meta.MetaClientID)
	b.MetaClientVersion.Append(meta.MetaClientVersion)
	b.MetaClientImplementation.Append(meta.MetaClientImplementation)
	b.MetaClientOS.Append(meta.MetaClientOS)
	b.MetaClientIP.Append(proto.NewNullable[proto.IPv6](flattener.ParseIPv6(meta.MetaClientIP)))
	b.MetaClientGeoCity.Append(meta.MetaClientGeoCity)
	b.MetaClientGeoCountry.Append(meta.MetaClientGeoCountry)
	b.MetaClientGeoCountryCode.Append(meta.MetaClientGeoCountryCode)
	b.MetaClientGeoContinentCode.Append(meta.MetaClientGeoContinentCode)
	b.MetaClientGeoLongitude.Append(proto.NewNullable[float64](meta.MetaClientGeoLongitude))
	b.MetaClientGeoLatitude.Append(proto.NewNullable[float64](meta.MetaClientGeoLatitude))
	b.MetaClientGeoAutonomousSystemNumber.Append(proto.NewNullable[uint32](meta.MetaClientGeoAutonomousSystemNumber))
	b.MetaClientGeoAutonomousSystemOrganization.Append(proto.NewNullable[string](meta.MetaClientGeoAutonomousSystemOrganization))
	b.MetaNetworkID.Append(int32(meta.MetaNetworkID))
	b.MetaNetworkName.Append(meta.MetaNetworkName)
}

func (b *consensusEngineApiNewPayloadBatch) Input() proto.Input {
	return proto.Input{
		{Name: "updated_date_time", Data: &b.UpdatedDateTime},
		{Name: "event_date_time", Data: &b.EventDateTime},
		{Name: "requested_date_time", Data: &b.RequestedDateTime},
		{Name: "duration_ms", Data: &b.DurationMs},
		{Name: "slot", Data: &b.Slot},
		{Name: "slot_start_date_time", Data: &b.SlotStartDateTime},
		{Name: "epoch", Data: &b.Epoch},
		{Name: "epoch_start_date_time", Data: &b.EpochStartDateTime},
		{Name: "block_root", Data: &b.BlockRoot},
		{Name: "parent_block_root", Data: &b.ParentBlockRoot},
		{Name: "proposer_index", Data: &b.ProposerIndex},
		{Name: "block_number", Data: &b.BlockNumber},
		{Name: "block_hash", Data: &b.BlockHash},
		{Name: "parent_hash", Data: &b.ParentHash},
		{Name: "gas_used", Data: &b.GasUsed},
		{Name: "gas_limit", Data: &b.GasLimit},
		{Name: "tx_count", Data: &b.TxCount},
		{Name: "blob_count", Data: &b.BlobCount},
		{Name: "status", Data: &b.Status},
		{Name: "latest_valid_hash", Data: b.LatestValidHash},
		{Name: "validation_error", Data: b.ValidationError},
		{Name: "method_version", Data: &b.MethodVersion},
		{Name: "meta_execution_version", Data: &b.MetaExecutionVersion},
		{Name: "meta_execution_implementation", Data: &b.MetaExecutionImplementation},
		{Name: "meta_execution_version_major", Data: &b.MetaExecutionVersionMajor},
		{Name: "meta_execution_version_minor", Data: &b.MetaExecutionVersionMinor},
		{Name: "meta_execution_version_patch", Data: &b.MetaExecutionVersionPatch},
		{Name: "meta_client_name", Data: &b.MetaClientName},
		{Name: "meta_client_id", Data: &b.MetaClientID},
		{Name: "meta_client_version", Data: &b.MetaClientVersion},
		{Name: "meta_client_implementation", Data: &b.MetaClientImplementation},
		{Name: "meta_client_os", Data: &b.MetaClientOS},
		{Name: "meta_client_ip", Data: b.MetaClientIP},
		{Name: "meta_client_geo_city", Data: &b.MetaClientGeoCity},
		{Name: "meta_client_geo_country", Data: &b.MetaClientGeoCountry},
		{Name: "meta_client_geo_country_code", Data: &b.MetaClientGeoCountryCode},
		{Name: "meta_client_geo_continent_code", Data: &b.MetaClientGeoContinentCode},
		{Name: "meta_client_geo_longitude", Data: b.MetaClientGeoLongitude},
		{Name: "meta_client_geo_latitude", Data: b.MetaClientGeoLatitude},
		{Name: "meta_client_geo_autonomous_system_number", Data: b.MetaClientGeoAutonomousSystemNumber},
		{Name: "meta_client_geo_autonomous_system_organization", Data: b.MetaClientGeoAutonomousSystemOrganization},
		{Name: "meta_network_id", Data: &b.MetaNetworkID},
		{Name: "meta_network_name", Data: &b.MetaNetworkName},
	}
}

func (b *consensusEngineApiNewPayloadBatch) Reset() {
	b.UpdatedDateTime.Reset()
	b.EventDateTime.Reset()
	b.RequestedDateTime.Reset()
	b.DurationMs.Reset()
	b.Slot.Reset()
	b.SlotStartDateTime.Reset()
	b.Epoch.Reset()
	b.EpochStartDateTime.Reset()
	b.BlockRoot.Reset()
	b.ParentBlockRoot.Reset()
	b.ProposerIndex.Reset()
	b.BlockNumber.Reset()
	b.BlockHash.Reset()
	b.ParentHash.Reset()
	b.GasUsed.Reset()
	b.GasLimit.Reset()
	b.TxCount.Reset()
	b.BlobCount.Reset()
	b.Status.Reset()
	b.LatestValidHash.Reset()
	b.ValidationError.Reset()
	b.MethodVersion.Reset()
	b.MetaExecutionVersion.Reset()
	b.MetaExecutionImplementation.Reset()
	b.MetaExecutionVersionMajor.Reset()
	b.MetaExecutionVersionMinor.Reset()
	b.MetaExecutionVersionPatch.Reset()
	b.MetaClientName.Reset()
	b.MetaClientID.Reset()
	b.MetaClientVersion.Reset()
	b.MetaClientImplementation.Reset()
	b.MetaClientOS.Reset()
	b.MetaClientIP.Reset()
	b.MetaClientGeoCity.Reset()
	b.MetaClientGeoCountry.Reset()
	b.MetaClientGeoCountryCode.Reset()
	b.MetaClientGeoContinentCode.Reset()
	b.MetaClientGeoLongitude.Reset()
	b.MetaClientGeoLatitude.Reset()
	b.MetaClientGeoAutonomousSystemNumber.Reset()
	b.MetaClientGeoAutonomousSystemOrganization.Reset()
	b.MetaNetworkID.Reset()
	b.MetaNetworkName.Reset()
	b.rows = 0
}

func (b *consensusEngineApiNewPayloadBatch) Snapshot() []map[string]any {
	n := b.rows
	out := make([]map[string]any, n)

	for i := 0; i < n; i++ {
		row := make(map[string]any, 43)
		row["updated_date_time"] = b.UpdatedDateTime.Row(i).Unix()
		row["event_date_time"] = b.EventDateTime.Row(i).UnixMilli()
		row["requested_date_time"] = b.RequestedDateTime.Row(i).UnixMilli()
		row["duration_ms"] = b.DurationMs.Row(i)
		row["slot"] = b.Slot.Row(i)
		row["slot_start_date_time"] = b.SlotStartDateTime.Row(i).Unix()
		row["epoch"] = b.Epoch.Row(i)
		row["epoch_start_date_time"] = b.EpochStartDateTime.Row(i).Unix()
		row["block_root"] = string(b.BlockRoot.Row(i))
		row["parent_block_root"] = string(b.ParentBlockRoot.Row(i))
		row["proposer_index"] = b.ProposerIndex.Row(i)
		row["block_number"] = b.BlockNumber.Row(i)
		row["block_hash"] = string(b.BlockHash.Row(i))
		row["parent_hash"] = string(b.ParentHash.Row(i))
		row["gas_used"] = b.GasUsed.Row(i)
		row["gas_limit"] = b.GasLimit.Row(i)
		row["tx_count"] = b.TxCount.Row(i)
		row["blob_count"] = b.BlobCount.Row(i)
		row["status"] = b.Status.Row(i)
		if v := b.LatestValidHash.Row(i); v.Set {
			row["latest_valid_hash"] = string(v.Value)
		} else {
			row["latest_valid_hash"] = nil
		}
		if v := b.ValidationError.Row(i); v.Set {
			row["validation_error"] = v.Value
		} else {
			row["validation_error"] = nil
		}
		row["method_version"] = b.MethodVersion.Row(i)
		row["meta_execution_version"] = b.MetaExecutionVersion.Row(i)
		row["meta_execution_implementation"] = b.MetaExecutionImplementation.Row(i)
		row["meta_execution_version_major"] = b.MetaExecutionVersionMajor.Row(i)
		row["meta_execution_version_minor"] = b.MetaExecutionVersionMinor.Row(i)
		row["meta_execution_version_patch"] = b.MetaExecutionVersionPatch.Row(i)
		row["meta_client_name"] = b.MetaClientName.Row(i)
		row["meta_client_id"] = b.MetaClientID.Row(i)
		row["meta_client_version"] = b.MetaClientVersion.Row(i)
		row["meta_client_implementation"] = b.MetaClientImplementation.Row(i)
		row["meta_client_os"] = b.MetaClientOS.Row(i)
		if v := b.MetaClientIP.Row(i); v.Set {
			row["meta_client_ip"] = net.IP(v.Value[:]).String()
		} else {
			row["meta_client_ip"] = nil
		}
		row["meta_client_geo_city"] = b.MetaClientGeoCity.Row(i)
		row["meta_client_geo_country"] = b.MetaClientGeoCountry.Row(i)
		row["meta_client_geo_country_code"] = b.MetaClientGeoCountryCode.Row(i)
		row["meta_client_geo_continent_code"] = b.MetaClientGeoContinentCode.Row(i)
		if v := b.MetaClientGeoLongitude.Row(i); v.Set {
			row["meta_client_geo_longitude"] = v.Value
		} else {
			row["meta_client_geo_longitude"] = nil
		}
		if v := b.MetaClientGeoLatitude.Row(i); v.Set {
			row["meta_client_geo_latitude"] = v.Value
		} else {
			row["meta_client_geo_latitude"] = nil
		}
		if v := b.MetaClientGeoAutonomousSystemNumber.Row(i); v.Set {
			row["meta_client_geo_autonomous_system_number"] = v.Value
		} else {
			row["meta_client_geo_autonomous_system_number"] = nil
		}
		if v := b.MetaClientGeoAutonomousSystemOrganization.Row(i); v.Set {
			row["meta_client_geo_autonomous_system_organization"] = v.Value
		} else {
			row["meta_client_geo_autonomous_system_organization"] = nil
		}
		row["meta_network_id"] = b.MetaNetworkID.Row(i)
		row["meta_network_name"] = b.MetaNetworkName.Row(i)
		out[i] = row
	}

	return out
}
